# Программа управления лифтами

## Логика работы

**Программа выполняется в 5 асинхронных потоках: главный поток (Main.java), поток-генератор вызовов (RequestGenerator.java), три потока-обработчика вызовов (LiftThread).**

1. Главный поток

   - Считывает MAX_TIME и averageCallTime - время работы нашей программы и среднее время генерации вызовов
   - Отвечает за начальную генерацию всего, что есть
   - Отсчитывает время и содержит основной Run loop
   - В этом цикле отрисовывает картинку в отдельном окне (на каждой итерации в класс передаются данные,
     которые нужно отрисовать, и в файле LiftsInterface рисуются)

2. Поток-генератор вызовов

   - Генерирует новые вызовы в формате (from, to)
   - Время между вызовами задается пользователем (averageCallTime), потом используется по формуле: ``` averageCallTime + randInt(averageCallTime / 4) ```. Чтобы было интереснее)

3. Поток-обработчик вызовов

   Это поток отвечающий за движение лифтов. У каждого лифта он свой, но все они работают с одними и теми же данными (потокобезопасными -
   AtomicBoolean, AtomicReferenceArray, BlockingQueue и т.д.)

   Есть несколько основных функций:

       moveLift() - отвечает за само движение лифта (вызывается раз в секунду)

       letPeopleOutOnCurrentFloor() - выпускает всех людей, которые доехали до нужного этажа

       takeNewPeopleOnCurrentFloor() - подбирает всех людей, которые едут в ту же сторону, что и лифт в данный момент
           времени
   
       findNewDestination() - если все люди из лифта вышли, то нужно найти на какой следующий этаж ехать,
           эта функция как раз так находит этот этаж, взяв тот, у которого коэффициент самый большой

       countCoefficients() - считает коэффициенты для каждого этажа для функции findNewDestination, основывается
           на удаленности этажа с людьми и количестве человек, которые уже стоят на это этаже и ждут (чем ближе этаж,
           тем больше коэффициент, чем больше людей ждет, тем больше коэффициент)

---

## Особенности работы лифтов

1. Лифты могут подбирать людей по дороге, если люди едут в ту же сторону, что и люди внутри лифта
2. Если на каком-то этаже накопилось очень много людей, то как только лифт освободиться, то из-за системы коэффициентов, вероятно поедет на такой этаж
3. Приоритет отдается, как и в жизни, тому кто раньше пришел к лифту. То есть именно он выбирает в какую сторону поедет лифт
4. Если один лифт отправился за людьми на каком-то этаже, то другие лифты уже не рассматривают этот этаж. Однако, если лифт проезжают через этот этаж и есть люди, двигающиеся в ту же сторону, что и лифт, то он их заберет.
5. Если пока лифт ехал на свой этаж людей там уже забрали - он останавливается и ищет новый этаж.
6. Если лифт доезжает до какого-то этажа, где выходят все люди, но на этаже есть новые люди, то он их заберет (как в жизни)
7. Если появится желание усовершенствовать "мозги" лифтов - нужно просто переписать функцию подсчета коэффициентов.
